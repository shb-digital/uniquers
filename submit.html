<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="footer-style.css">  
  <link rel="apple-touch-icon" href="favicon.png"> <!-- iOS 홈화면용 -->
  <link rel="shortcut icon" href="favicon.png" type="image/png">
    <!-- Pretendard Variable CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable-dynamic-subset.css">

  <title>아이디어 접수</title>
  <style>
    /* ====== Global & Form ====== */
    :root{
      --text:#0b1220; --muted:#666; --primary:#0046ff; --line:#e6e9ef; --ring:rgba(0,70,255,.18);
      --header-h:64px; --ink:#0b1220; --muted2:#6b7280; --line2:#e5e7eb; --bg:#ffffffF2;
      --container:1200px;
    }
    html,body{margin:0}
    body {
        margin: 0;
        font-family: 'Pretendard Variable', Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", Arial, "Noto Sans KR", sans-serif;
        font-size: 15px;
        line-height: 1.65;
        color: var(--text);
    } 
    main{padding-top:8px}                  /* 고정 헤더 보정 */
    :target{scroll-margin-top:var(--header-h)} /* 앵커 이동 보정 */

    /* ✅ 본문 컨테이너: 좌우 여백 + 최대너비 */
    [doz_type="inside"]{
      max-width:var(--container);
      margin:0 auto;
      padding:0 24px;
    }
    @media (max-width:480px){
      [doz_type="inside"]{ padding:0 16px; }
    }

    /* ✅ 12-그리드: PC 두 칼럼 / 모바일 스택 */
    .doz_row{
      display:grid;
      grid-template-columns:repeat(12, minmax(0,1fr));
      gap:20px;
      align-items:start;
    }
    .col-dz-12{ grid-column:span 12; }
    .col-dz-6{ grid-column:span 6; }  /* 팀장/팀원 */
    @media (max-width:900px){
      .col-dz-6{ grid-column:span 12; } /* 모바일에서 줄바꿈 */
    }

    /* 섹션 수직 간격 (답답함 완화) */
    .section_wrap main{ padding:32px 0; }
    @media (max-width:900px){ .section_wrap main{ padding:24px 0; } }

    .il-field{display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
    .il-label{font-weight:800;color:#333}
    .il-help{font-size:12px;color:#888}
    .il-input,.il-select,.il-textarea{appearance:none;border:1.5px solid var(--line);border-radius:12px;padding:12px 14px;font:inherit}
    .il-textarea{min-height:320px;resize:vertical}
    .il-input:focus,.il-select:focus,.il-textarea:focus{outline:none;border-color:#9fb0ce;box-shadow:0 0 0 6px var(--ring)}
    .il-btn{border:1px solid var(--line);background:var(--primary);color:#fff;border-radius:12px;padding:12px 18px;font-weight:800;cursor:pointer}
    .il-btn.secondary{background:#fff;color:var(--primary)}
    .il-grid2{display:grid;grid-template-columns:1fr;gap:16px}
    .il-grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media (max-width:900px){.il-grid2,.il-grid3{grid-template-columns:1fr}}
    .il-note{font-size:12px;color:#888}

    .overlay{position:fixed;inset:0;background:rgba(8,14,30,.45);display:none;backdrop-filter:blur(6px)}
    .modal{position:fixed;inset:0;display:none;place-items:center;padding:20px}
    .dialog{width:min(560px,100%);background:#fff;border:1px solid var(--line);border-radius:20px;box-shadow:0 8px 30px rgba(0,0,0,.12)}
    .dialog .bd{padding:22px 22px 18px}
    .dialog .ft{display:flex;gap:8px;justify-content:flex-end;padding:0 22px 22px}

    .form-actions{display:flex;flex-direction:column;gap:10px;margin-top:12px}
    .form-actions .il-btn{width:100%;display:block;text-align:center}

    .il-btn{position:relative;overflow:hidden;transition:transform .12s ease,box-shadow .2s ease,opacity .2s ease}
    .il-btn:active{transform:translateY(1px) scale(.99)}
    .il-btn.is-sending{pointer-events:none;opacity:.96;box-shadow:0 0 0 6px var(--ring)}
    .il-btn.is-sending::after{
      content:"";position:absolute;inset:0;
      background:linear-gradient(120deg,rgba(255,255,255,0) 0%,rgba(255,255,255,.35) 45%,rgba(255,255,255,0) 90%);
      transform:translateX(-120%);animation:btnShimmer 1.1s linear infinite;
    }
    @keyframes btnShimmer{0%{transform:translateX(-120%)}100%{transform:translateX(120%)}}

    /* Confirm Modal */
    #confirmModal{display:none;place-items:center;padding:20px}
    #confirmModal .dialog{width:min(520px,92%);border-radius:24px;border:1px solid #e8edf5;box-shadow:0 24px 60px rgba(12,18,31,.18);overflow:hidden}
    #confirmModal .bd{padding:28px 28px 18px}
    #confirmModal h3{margin:0 0 6px;font-size:20px;line-height:1.35;letter-spacing:-.02em;color:#0b1220;text-align:center;font-weight:800}
    #confirmModal .bd>p{margin:0 0 14px;text-align:center;color:#6b7684}
    #confirmModal .review-box{background:#f7f9fd;border:1px solid #e6ebf4;border-radius:16px;padding:6px 0;margin-top:8px}
    #confirmModal .cf-row{display:grid;grid-template-columns:120px 1fr;gap:12px;padding:12px 16px;align-items:center}
    #confirmModal .cf-row + .cf-row{border-top:1px dashed #e2e8f3}
    #confirmModal .cf-label{font-weight:800;color:#111827}
    #confirmModal .cf-value{color:#334155;word-break:break-word}
    #confirmModal .bd .il-note{margin-top:12px;text-align:center}
    #confirmModal .ft{display:flex;gap:10px;justify-content:flex-end;padding:0 24px 22px}
    #confirmModal .ft .il-btn{border-radius:12px;padding:12px 18px}

    /* Success Modal */
    #successModal{display:none;place-items:center;padding:20px}
    #successModal .dialog{width:min(520px,92%);border-radius:24px;border:1px solid #e8edf5;box-shadow:0 24px 60px rgba(12,18,31,.18);overflow:hidden}
    #successModal .bd{padding:28px 28px 18px;text-align:center}
    #successModal h3{margin:0 0 6px;font-size:20px;letter-spacing:-.02em;color:#0b1220;font-weight:800}
    #successModal .sub{margin:0 0 14px;color:#6b7684}
    .sm-code{display:inline-flex;gap:10px;align-items:center;justify-content:center;padding:14px 18px;border-radius:14px;border:1px solid #e6ebf4;background:#f7f9fd;font-weight:900;letter-spacing:.12em;font-size:28px;color:#0b1220;font-variant-numeric:tabular-nums;}
    .sm-actions{display:flex;gap:8px;justify-content:center;margin-top:14px}
    .sm-link{display:none}
    #successModal .ft #smClose{min-width:200px;padding:14px 28px;font-size:16px}
    @media (max-width:480px){ #successModal .ft #smClose{width:100%} }

    /* ====== Header ====== */
    .site-header,*{box-sizing:border-box}
    .site-header{
      position:sticky; top:0; z-index:1000;
      backdrop-filter:saturate(140%) blur(8px);
      -webkit-backdrop-filter:saturate(140%) blur(8px);
      background:var(--bg);
      border-bottom:1px solid rgba(17,24,39,.06);
    }
    .site-header .bar{
      max-width:var(--container); margin:0 auto; height:var(--header-h);
      padding:0 20px; display:flex; align-items:center; gap:16px;
    }
    .brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--ink); font-weight:900; letter-spacing:.02em;}
    .brand .title{font-size:18px; color:#676767;}
    nav{margin-left:auto}
    .nav-list{display:flex; gap:6px; align-items:center; list-style:none; margin:0; padding:0;}
    .nav-list a{display:inline-flex; align-items:center; gap:6px; padding:10px 12px; border-radius:10px; text-decoration:none; color:var(--ink); font-weight:700; letter-spacing:-.01em;}
    .nav-list a:hover{background:#f3f5f9}
    .nav-list a.active{color:var(--primary); background:#eef3ff; border:1px solid #dbe7ff}
    .btn-primary{background:linear-gradient(90deg,#0046ff,#2f6bff); color:#fff; border:none; padding:10px 14px; border-radius:10px; font-weight:800;}
    .btn-primary:hover{filter:brightness(1.03)}
    .hamb{display:none; margin-left:auto}
    .hamb button{
      appearance:none; width:40px;height:40px;border-radius:10px;border:1px solid var(--line2);
      background:#fff; display:grid; place-items:center; cursor:pointer;
    }
    .hamb svg{width:20px;height:20px}
    .drawer{
      display:none; position:fixed; inset:var(--header-h) 0 auto 0; z-index:999;
      background:#fff; border-top:1px solid var(--line2); box-shadow:0 12px 30px rgba(0,0,0,.08);
      padding:10px 16px;
    }
    .drawer a{ display:block; padding:12px 10px; border-radius:10px; color:var(--ink); text-decoration:none; font-weight:700}
    .drawer a + a{margin-top:4px}
    .drawer a:hover{background:#f3f5f9}
    .drawer a.active{color:var(--primary); background:#eef3ff; border:1px solid #dbe7ff}
    @media (max-width:960px){ nav{display:none} .hamb{display:block} }
    @media (prefers-reduced-motion:reduce){ .site-header{backdrop-filter:none; -webkit-backdrop-filter:none} }
    .drawer { z-index: 1001; }
    .site-header { z-index: 1000; }
  </style>
</head>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('menuBtn');
    const drawer = document.getElementById('mobileMenu');
    if (!btn || !drawer) return;

    function open() {
      drawer.hidden = false;
      drawer.style.display = 'block';
      btn.setAttribute('aria-expanded', 'true');
      btn.setAttribute('aria-label', '메뉴 닫기');
      // 바깥 클릭/ESC로 닫기
      document.addEventListener('click', outside, { capture: true });
      document.addEventListener('keydown', esc);
    }

    function close() {
      drawer.style.display = 'none';
      drawer.hidden = true;
      btn.setAttribute('aria-expanded', 'false');
      btn.setAttribute('aria-label', '메뉴 열기');
      document.removeEventListener('click', outside, { capture: true });
      document.removeEventListener('keydown', esc);
    }

    function outside(e) {
      if (!drawer.contains(e.target) && !btn.contains(e.target)) close();
    }
    function esc(e) {
      if (e.key === 'Escape') close();
    }

    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const expanded = btn.getAttribute('aria-expanded') === 'true';
      expanded ? close() : open();
    });
  });
</script>
<body>
  <!-- ===== Header ===== -->
  <header class="site-header" role="banner">
    <div class="bar" aria-label="Global">
      <a class="brand" href="/uniquers/"><span class="title">2025 UNIQUERS</span></a>

      <nav aria-label="Primary">
        <ul class="nav-list">
          <li><a href="/uniquers/">홈</a></li>
          <li><a href="/uniquers/submit.html">아이디어 접수</a></li>
          <li><a href="/uniquers/inquiry.html">아이디어 조회</a></li>
        </ul>
      </nav>

      <div class="hamb">
        <button id="menuBtn" aria-expanded="false" aria-controls="mobileMenu" aria-label="메뉴 열기">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="2" stroke-linecap="round" d="M4 7h16M4 12h16M4 17h16"/></svg>
        </button>
      </div>
    </div>

    <nav class="drawer" id="mobileMenu" hidden aria-label="Mobile">
      <ul style="list-style:none;margin:0;padding:0">
        <li><a href="/uniquers/">홈</a></li>
        <li><a href="/uniquers/submit.html">아이디어 접수</a></li>
        <li><a href="/uniquers/inquiry.html">아이디어 조회</a></li>
      </ul>
    </nav>
  </header>

  <!-- ===== Page Content ===== -->
  <div doz_type="section" class="section_wrap pc_section side_" id="s2025081937df5229f77af" style="background-color:rgba(248,249,250,1);" doz_change_mobile="N">
    <main>
      <div doz_type="inside" class="inside">
        <!-- 타이틀 -->
        <div doz_type="row" doz_grid="12" class="doz_row">
          <div doz_type="grid" doz_grid="12" class="col-dz col-dz-12">
            <h2 style="text-align:center;font-size:36px;color:#0046ff;margin-bottom:20px;font-weight:bold;">접수 양식</h2>
            <p style="text-align:center;font-size:16px;color:#666;margin-bottom:40px;"><b>로그인 없이 작성 및 제출 가능합니다!</b><br>아래 양식에 따라 아이디어를 작성해주세요</p>
          </div>
        </div>

        <!-- 팀장 / 팀원 (PC: 6+6 / Mobile: 12) -->
        <div doz_type="row" doz_grid="12" class="doz_row">
          <div doz_type="grid" doz_grid="6" class="col-dz col-dz-6">
            <div style="background:#ffffff;padding:30px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.08);margin-bottom:20px;">
              <h3 style="font-size:20px;color:#0046ff;margin-bottom:20px;font-weight:bold;">👥 팀장</h3>
              <div class="il-field"><label class="il-label" for="leadEmp">행번<span style="color:#0046ff"> *</span></label><input class="il-input" id="leadEmp" type="text" inputmode="numeric" maxlength="8" minlength="8" pattern="\d+" placeholder="예: 20004000" required></div>
              <div class="il-field"><label class="il-label" for="leadName">이름<span style="color:#0046ff"> *</span></label><input class="il-input" id="leadName" type="text" placeholder="예: 홍신한" required></div>
              <div class="il-field"><label class="il-label" for="leadDept">부서명<span style="color:#0046ff"> *</span></label><input class="il-input" id="leadDept" type="text" placeholder="예: 디지털솔루션부" required></div>
              <div class="il-field"><label class="il-label" for="leadEmail">이메일</label><input class="il-input" id="leadEmail" type="email" placeholder="예: name@gmail.com"></div>
              <div class="il-help">팀장 정보는 필수입니다. (이메일은 선택)</div>
            </div>
          </div>

          <div doz_type="grid" doz_grid="6" class="col-dz col-dz-6">
            <div style="background:#ffffff;padding:30px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.08);margin-bottom:20px;">
              <h3 style="font-size:20px;color:#0046ff;margin-bottom:20px;font-weight:bold;">👥 팀원 (선택, 최대 1명)</h3>
              <div class="il-field"><label class="il-label" for="memberEmp">행번</label><input class="il-input" id="memberEmp" type="text" inputmode="numeric" pattern="\d+" maxlength="8" minlength="8" placeholder="예: 10003000"></div>
              <div class="il-field"><label class="il-label" for="memberName">이름</label><input class="il-input" id="memberName" type="text" placeholder="예: 김몰리"></div>
              <div class="il-field"><label class="il-label" for="memberDept">부서명</label><input class="il-input" id="memberDept" type="text" placeholder="예: 서소문지점"></div>
              <div class="il-field"><label class="il-label" for="memberEmail">이메일</label><input class="il-input" id="memberEmail" type="email" placeholder="예: member@naver.com"></div>
              <div class="il-note" style="margin-top:6px">팀원 정보는 선택이며, 입력하지 않아도 제출 가능합니다.</div>
            </div>
          </div>
        </div>

        <!-- 카테고리 -->
        <div doz_type="row" doz_grid="12" class="doz_row">
          <div doz_type="grid" doz_grid="12" class="col-dz col-dz-12">
            <div style="background:#ffffff;padding:30px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.08);margin-bottom:20px;">
              <h3 style="font-size:20px;color:#0046ff;margin-bottom:20px;font-weight:bold;">📂 카테고리 선택</h3>
              <div class="il-field">
                <label class="il-label" for="category">주제 분류 (제휴신사업/디지털신사업)<span style="color:#0046ff"> *</span></label>
                <select class="il-select" id="category">
                  <option value="제휴신사업" selected>1번: 제휴신사업</option>
                  <option value="디지털신사업">2번: 디지털신사업</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- 아이디어 상세 -->
        <div doz_type="row" doz_grid="12" class="doz_row">
          <div doz_type="grid" doz_grid="12" class="col-dz col-dz-12">
            <div style="background:#ffffff;padding:40px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.08);">
              <h3 style="font-size:24px;color:#0046ff;margin-bottom:30px;font-weight:bold;">✍️ 아이디어 상세 내용</h3>
              <div class="il-grid2" style="margin-bottom:10px">
                <div class="il-field">
                  <label class="il-label" for="title">주제<span style="color:#0046ff"> *</span></label>
                  <input class="il-input" id="title" type="text" placeholder="아이디어의 핵심 주제" required>
                  <div class="il-help">간결하게 핵심만 (100자 이내 권장)</div>
                </div>
                <div class="il-field">
                  <label class="il-label" for="bg">제안 배경<span style="color:#0046ff"> *</span></label>
                  <textarea class="il-textarea" id="bg"  minlength="100" maxlength="2000" placeholder="배경과 필요성 (최대 2000자)" required></textarea>
                  <div class="il-help" id="ctrBg">0 / 2000</div>
                </div>
                <div class="il-field">
                  <label class="il-label" for="detail">아이디어 상세내용<span style="color:#0046ff"> *</span></label>
                  <textarea class="il-textarea" id="detail" minlength="100" maxlength="2000" placeholder="구체 내용과 실행 방안 (최대 2000자)" required></textarea>
                  <div class="il-help" id="ctrDetail">0 / 2000</div>
                </div>
                <div class="il-field">
                  <label class="il-label" for="impact">기대효과<span style="color:#0046ff"> *</span></label>
                  <textarea class="il-textarea" id="impact"  minlength="100" maxlength="2000" placeholder="예상 효과와 성과 (최대 2000자)" required></textarea>
                  <div class="il-help" id="ctrImpact">0 / 2000</div>
                </div>
              </div>

              <div class="form-actions">
                <button id="submitBtn" class="il-btn" type="button">제출하기</button>
                <div class="il-note">제출 후, 등록이 정상적으로 되면 접수번호 6자리 발급됩니다.</div>
              </div>
            </div>
          </div>
        </div>

        <!-- 여백 -->
        <div doz_type="row" doz_grid="12" class="doz_row">
          <div class="col-dz col-dz-12" style="height:10px"></div>
        </div>
      </div>
    </main>
    
  </div>

      <!-- ===== Footer ===== -->
    <footer class="site-footer" style="text-align:center !important;">
        <div style=" max-width:1200px;  margin:0 auto;  text-align:center;  line-height:1.6;">
            <p style="  margin:0;  font-weight:700;  color:#0b1220; text-align:center !important;">2025 UNIQUERS</p>
            <p class="contact">문의 : uniquers@shinhan.com</p>
        </div>
    </footer>
  <!-- ===== Modals / Scripts (변경 없음) ===== -->
  <div class="overlay" id="overlay"></div>

  <div class="modal" id="confirmModal">
    <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <div class="bd">
        <h3 id="confirmTitle">제출 전 확인</h3>
        <p>아래 정보가 맞는지 확인해 주세요.</p>
        <div class="review-box">
          <div class="cf-row"><div class="cf-label">주제 분류</div><div id="cfCat" class="cf-value">-</div></div>
          <div class="cf-row"><div class="cf-label">팀장 행번</div><div id="cfEmp" class="cf-value">-</div></div>
          <div class="cf-row"><div class="cf-label">주제</div><div id="cfTitle" class="cf-value">-</div></div>
        </div>
        <p class="il-note">제출 후 일부 정보는 수정이 불가능합니다.</p>
      </div>
      <div class="ft">
        <button class="il-btn secondary" id="cfCancel">취소</button>
        <button class="il-btn" id="cfOk">이대로 제출</button>
      </div>
    </div>
  </div>

  <!-- Success Modal (예쁘게) -->
<div class="modal" id="successModal">
  <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="smTitle">
    <div class="bd">
      <h3 id="smTitle">제출이 완료되었습니다 🎉</h3>
      <p class="sub">아래 <b>접수번호 6자리</b>를 안전한 곳에 보관해 주세요.</p>
      <div class="sm-code" id="smCode" aria-live="polite">- - - - - -</div>
      <div class="sm-actions">
        <button class="il-btn " id="smCopy">코드 복사</button>
        <button class="il-btn secondary" id="smClose">닫기</button>
        <a id="smDocLink" class="il-btn secondary sm-link" target="_blank" rel="noopener">문서 열기</a>
      </div>
    </div>
  </div>
</div>


<script>
  // ======= GAS 웹앱 URL =======
  const GAS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbxhr26Xh3P1JX7QjUWLyOrul55zPV7Ha6ZMZGSt3k8fWbixzy6c2OhwFuBtVEEJg9OR/exec';

  // 유틸
  const val = id => (document.getElementById(id)?.value || '').trim();
  const setCounter = (id, ctrId) => {
    const el = document.getElementById(id), ctr = document.getElementById(ctrId);
    if (!el || !ctr) return;
    const update = () => ctr.textContent = `${el.value.length} / ${el.maxLength}`;
    el.addEventListener('input', update); update();
  };
  setCounter('bg','ctrBg'); setCounter('detail','ctrDetail'); setCounter('impact','ctrImpact');

  // 접수번호(6자리) – 맨 앞 0 방지
  const genCodeNoLeadingZero = (len = 6) => {
    const first = String(Math.floor(Math.random() * 9) + 1); // 1~9
    let rest = '';
    for (let i = 0; i < len - 1; i++) rest += String(Math.floor(Math.random() * 10));
    return first + rest;
  };

  // ===== 확인 모달 =====
  const overlay = document.getElementById('overlay');
  const confirmModal = document.getElementById('confirmModal');
  const successModal = document.getElementById('successModal');

  const openConfirm = (cat, emp, title) => {
    document.getElementById('cfCat').textContent = cat || '신사업제휴';
    document.getElementById('cfEmp').textContent = emp || '-';
    document.getElementById('cfTitle').textContent = title || '-';
    overlay.style.display = 'block';
    confirmModal.style.display = 'grid';
  };
  const closeConfirm = () => { confirmModal.style.display = 'none'; overlay.style.display = 'none'; };
  document.getElementById('cfCancel').addEventListener('click', closeConfirm);

  // ===== 성공 모달 =====
  const openSuccess = (code, docUrl) => {
    document.getElementById('smCode').textContent = code || '- - - - - -';
    const linkEl = document.getElementById('smDocLink');
    if (docUrl) { linkEl.href = docUrl; linkEl.style.display = 'inline-flex'; }
    else { linkEl.removeAttribute('href'); linkEl.style.display = 'none'; }
    overlay.style.display = 'block';
    successModal.style.display = 'grid';
  };
  const closeSuccess = () => { successModal.style.display = 'none'; overlay.style.display = 'none'; };
  document.getElementById('smClose').addEventListener('click', closeSuccess);
  document.getElementById('smCopy').addEventListener('click', async (e) => {
    const code = document.getElementById('smCode').textContent.trim();
    try { await navigator.clipboard.writeText(code); } catch(_) {
      const ta = document.createElement('textarea'); ta.value = code; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
    }
    const btn = e.currentTarget; const prev = btn.textContent; btn.textContent='복사됨'; setTimeout(()=>btn.textContent=prev,1100);
  });

  // 오버레이/ESC로 닫기 (두 모달 모두)
  overlay.addEventListener('click', () => { closeConfirm(); closeSuccess(); });
  document.addEventListener('keydown', e => { if (e.key === 'Escape') { closeConfirm(); closeSuccess(); } });

  // 제출 버튼 → 확인 모달
  document.getElementById('submitBtn').addEventListener('click', () => {
    if (!GAS_ENDPOINT.includes('https')) { alert('먼저 GAS 웹앱 URL(GAS_ENDPOINT)을 설정하세요.'); return; }
    const requiredIds = ['leadEmp','leadName','leadDept','title','bg','detail','impact'];
    for (const id of requiredIds) {
      if (!val(id)) { document.getElementById(id)?.focus(); alert('필수 입력을 확인하세요.'); return; }
    }
    const catEl = document.getElementById('category');
    const cat = catEl ? (catEl.value || catEl.options[catEl.selectedIndex]?.text) : '';
    openConfirm(cat, val('leadEmp'), val('title'));
  });

  // 실제 전송
  async function submitToGAS(){
    const fallbackCode = genCodeNoLeadingZero(6);

    const payload = {
      category: val('category'),
      title: val('title'),
      background: val('bg'),
      details: val('detail'),
      impact: val('impact'),
      teamLead: { empNo: val('leadEmp'), name: val('leadName'), dept: val('leadDept'), email: val('leadEmail') },
      teamMembers: (() => {
        const emp = val('memberEmp'), name = val('memberName'), dept = val('memberDept'), email = val('memberEmail');
        return (emp || name || dept || email) ? [{ empNo: emp, name, dept, email }] : [];
      })(),
      clientCode: fallbackCode,
      submittedAt: new Date().toISOString(),
      ua: navigator.userAgent
    };

    for (const k of ['background','details','impact']) {
      if ((payload[k] || '').length > 2000) { alert('텍스트 길이 제한(2000자)을 초과했습니다.'); return; }
    }
    for (const k of ['background','details','impact']) {
      if ((payload[k] || '').length < 100) { alert('최소 텍스트 길이를(100자) 작성해주세요.'); return; }
    }

    const btn = document.getElementById('submitBtn');
    const oldText = btn.textContent;
    btn.disabled = true; btn.textContent = '제출 중…'; btn.classList.add('is-sending');

    try {
      const res = await fetch(GAS_ENDPOINT, { method: 'POST', body: JSON.stringify(payload) });
      const text = await res.text();

      let shownCode = null, docUrl = null;
      let ok = false, errMsg = '';
      try {
        const data = JSON.parse(text);
        ok = !!data?.ok;
        // 코드 선택 (앞 0 방지)
        if (data?.code) {
          shownCode = String(data.code);
          if (/^0/.test(shownCode)) shownCode = payload.clientCode;
        } else {
          shownCode = payload.clientCode;
        }
        // 문서 링크 추정 키들
        docUrl = data?.docUrl || data?.url || data?.link || null;
        if (!ok) errMsg = data?.message || '제출 실패';
      } catch { errMsg = '제출 실패 (JSON 파싱 오류)'; }

      if (ok) {
        // 폼 리셋
        ['leadEmp','leadName','leadDept','leadEmail','memberEmp','memberName','memberDept','memberEmail','category','title','bg','detail','impact']
          .forEach(id => { const el = document.getElementById(id); if (el) el.value = ''; });
        const sel = document.getElementById('category'); if (sel) sel.value = '신사업제휴';
        setCounter('bg','ctrBg'); setCounter('detail','ctrDetail'); setCounter('impact','ctrImpact');

        // 성공 모달 오픈
        openSuccess(shownCode, docUrl);
      } else {
        alert(errMsg || '제출 실패');
      }
    } catch(e){
      alert('네트워크/권한 오류: ' + e);
    } finally {
      btn.disabled = false; btn.textContent = oldText; btn.classList.remove('is-sending');
    }
  }

  document.getElementById('cfOk').addEventListener('click', async () => { 
    // 확인 모달 닫고 실제 제출
    confirmModal.style.display = 'none';
    await submitToGAS();
  });
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2N53L5722Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2N53L5722Q');
</script>            
<!-- Apps Script(백엔드)는 기존과 동일 사용 -->
</body>

</html>




